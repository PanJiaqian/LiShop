{"version":3,"file":"index.js","sources":["pages/login/index.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vaW5kZXgudnVl"],"sourcesContent":["<template>\r\n  <view class=\"login-container\">\r\n    <Skeleton :loading=\"loading\" />\r\n    <!-- #ifdef MP-WEIXIN -->\r\n    <image class=\"bg-image\" src=\"/static/product_detail_background.jpg\" mode=\"aspectFill\" />\r\n    <!-- #endif -->\r\n    <!-- #ifndef MP-WEIXIN -->\r\n    <image class=\"bg-image\" src=\"/static/login_background.jpg\" mode=\"aspectFill\" />\r\n    <!-- #endif -->\r\n    \r\n    \r\n\r\n    <view class=\"login-card\">\r\n      <!-- #ifdef MP-WEIXIN -->\r\n      <image src=\"/static/logo.png\" style=\"width:200rpx;height:200rpx;display:block;margin:0 auto;\" mode=\"aspectFit\" />\r\n      <!-- #endif -->\r\n      <!-- #ifndef MP-WEIXIN -->\r\n      <image src=\"/static/logo.png?v=20251211\" style=\"width:200rpx;height:200rpx;display:block;margin:0 auto;\" mode=\"aspectFit\" />\r\n      <!-- #endif -->\r\n      <view class=\"input-group\">\r\n        <input class=\"glass-input\" type=\"text\" v-model=\"username\" placeholder=\"账号\" placeholder-class=\"ph-style\" />\r\n      </view>\r\n      <view class=\"input-group\">\r\n        <input class=\"glass-input\" type=\"password\" v-model=\"password\" placeholder=\"密码\" placeholder-class=\"ph-style\" />\r\n      </view>\r\n      <button class=\"login-btn\" @tap=\"login\">登录</button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport Skeleton from '@/components/Skeleton.vue'\r\nimport { loginAdmin } from '../../api/index.js'\r\nexport default {\r\n  components: { Skeleton },\r\n  data() {\r\n    return { username: '', password: '', loading: true }\r\n  },\r\n  onShow() {\r\n    try {\r\n      const u = uni.getStorageSync('user') || null\r\n      const exp = uni.getStorageSync('token_expiration') || 0\r\n      const valid = !!u && (!exp || Date.now() < exp)\r\n      if (valid) {\r\n        if (uni && uni.switchTab) { uni.switchTab({ url: '/pages/home/index' }); return }\r\n        if (uni && uni.navigateTo) { uni.navigateTo({ url: '/pages/home/index' }); return }\r\n      }\r\n    } catch (e) {}\r\n    this.loading = false\r\n  },\r\n  methods: {\r\n    login() {\r\n      if (!this.username || !this.password) {\r\n        uni.showToast({ title: 'Please enter username and password', icon: 'none' })\r\n        return\r\n      }\r\n      const payload = { phone: this.username, password: this.password }\r\n      uni.showLoading({ title: 'Logging in...', mask: true })\r\n      loginAdmin(payload)\r\n        .then((dataRaw) => {\r\n          let data = dataRaw\r\n          if (typeof data === 'string') { try { data = JSON.parse(data) } catch (e) {} }\r\n          const user = { username: this.username, ...(data || {}) }\r\n          try {\r\n            uni.setStorageSync('user', user)\r\n            uni.setStorageSync('token_expiration', Date.now() + 4 * 24 * 60 * 60 * 1000)\r\n            uni.setStorageSync('just_logged_in', true)\r\n          } catch (e) { }\r\n          // uni.showToast({ title: 'Login Success', icon: 'success' })\r\n          setTimeout(() => {\r\n            try {\r\n              if (uni && uni.switchTab) { uni.switchTab({ url: '/pages/home/index' }); return }\r\n              if (uni && uni.reLaunch) { uni.reLaunch({ url: '/pages/home/index' }); return }\r\n              if (uni && uni.navigateTo) { uni.navigateTo({ url: '/pages/home/index' }); return }\r\n            } catch (e) {\r\n              try { uni.navigateTo({ url: '/pages/home/index' }) } catch (e2) {}\r\n            }\r\n          }, 300)\r\n        })\r\n        .catch((err) => {\r\n          console.error('login error', err)\r\n          uni.showToast({ title: '账号或密码错误', icon: 'none' })\r\n        })\r\n        .finally(() => { try { uni.hideLoading() } catch (e) {} })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n  position: relative;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\n\r\n.bg-image {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 0;\r\n}\r\n\r\n.top-bar {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  padding: 40rpx 60rpx;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  z-index: 10;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.brand-title {\r\n  font-size: 48rpx;\r\n  font-weight: bold;\r\n  color: #000;\r\n  font-family: sans-serif;\r\n}\r\n\r\n.menu-icon {\r\n  font-size: 48rpx;\r\n  color: #000;\r\n}\r\n\r\n.login-card {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 600rpx;\r\n  padding: 60rpx 40rpx;\r\n  background: rgba(255, 255, 255, 0.2); /* Glassmorphism */\r\n  backdrop-filter: blur(20px);\r\n  -webkit-backdrop-filter: blur(20px);\r\n  border-radius: 30rpx;\r\n  border: 1px solid rgba(255, 255, 255, 0.3);\r\n  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.1);\r\n  z-index: 10;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 40rpx;\r\n}\r\n\r\n/* #ifdef H5 */\r\n.login-card { left: 30%; }\r\n/* #endif */\r\n\r\n.input-group {\r\n  width: 100%;\r\n}\r\n\r\n.glass-input {\r\n  width: 100%;\r\n  height: 100rpx;\r\n  background: rgba(255, 255, 255, 0.4);\r\n  border: 1px solid rgba(255, 255, 255, 0.5);\r\n  border-radius: 16rpx;\r\n  padding: 0 30rpx;\r\n  font-size: 32rpx;\r\n  color: #333;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.ph-style {\r\n  color: #666;\r\n}\r\n\r\n.login-btn {\r\n  width: 100%;\r\n  height: 100rpx;\r\n  line-height: 100rpx;\r\n  background: #000;\r\n  color: #fff;\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n  border-radius: 16rpx;\r\n  margin-top: 20rpx;\r\n  letter-spacing: 2rpx;\r\n}\r\n\r\n.login-btn:active {\r\n  opacity: 0.9;\r\n  transform: scale(0.98);\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/HP/Desktop/LiShop/LiShop/pages/login/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","loginAdmin"],"mappings":";;;;AA+BA,MAAO,WAAU,MAAW;AAE5B,MAAK,YAAU;AAAA,EACb,YAAY,EAAE,SAAU;AAAA,EACxB,OAAO;AACL,WAAO,EAAE,UAAU,IAAI,UAAU,IAAI,SAAS,KAAK;AAAA,EACpD;AAAA,EACD,SAAS;AACP,QAAI;AACF,YAAM,IAAIA,cAAG,MAAC,eAAe,MAAM,KAAK;AACxC,YAAM,MAAMA,cAAG,MAAC,eAAe,kBAAkB,KAAK;AACtD,YAAM,QAAQ,CAAC,CAAC,MAAM,CAAC,OAAO,KAAK,IAAI,IAAI;AAC3C,UAAI,OAAO;AACT,YAAIA,uBAAOA,cAAAA,MAAI,WAAW;AAAEA,wBAAG,MAAC,UAAU,EAAE,KAAK,qBAAqB;AAAG;AAAA,QAAO;AAChF,YAAIA,uBAAOA,cAAAA,MAAI,YAAY;AAAEA,wBAAG,MAAC,WAAW,EAAE,KAAK,qBAAqB;AAAG;AAAA,QAAO;AAAA,MACpF;AAAA,aACO,GAAG;AAAA,IAAC;AACb,SAAK,UAAU;AAAA,EAChB;AAAA,EACD,SAAS;AAAA,IACP,QAAQ;AACN,UAAI,CAAC,KAAK,YAAY,CAAC,KAAK,UAAU;AACpCA,sBAAG,MAAC,UAAU,EAAE,OAAO,sCAAsC,MAAM,QAAQ;AAC3E;AAAA,MACF;AACA,YAAM,UAAU,EAAE,OAAO,KAAK,UAAU,UAAU,KAAK,SAAS;AAChEA,oBAAG,MAAC,YAAY,EAAE,OAAO,iBAAiB,MAAM,MAAM;AACtDC,gBAAAA,WAAW,OAAO,EACf,KAAK,CAAC,YAAY;AACjB,YAAI,OAAO;AACX,YAAI,OAAO,SAAS,UAAU;AAAE,cAAI;AAAE,mBAAO,KAAK,MAAM,IAAI;AAAA,UAAA,SAAW,GAAG;AAAA,UAAA;AAAA,QAAG;AAC7E,cAAM,OAAO,EAAE,UAAU,KAAK,UAAU,GAAI,QAAQ,GAAI;AACxD,YAAI;AACFD,8BAAI,eAAe,QAAQ,IAAI;AAC/BA,wBAAAA,MAAI,eAAe,oBAAoB,KAAK,IAAG,IAAK,IAAI,KAAK,KAAK,KAAK,GAAI;AAC3EA,8BAAI,eAAe,kBAAkB,IAAI;AAAA,iBAClC,GAAG;AAAA,QAAE;AAEd,mBAAW,MAAM;AACf,cAAI;AACF,gBAAIA,uBAAOA,cAAAA,MAAI,WAAW;AAAEA,4BAAG,MAAC,UAAU,EAAE,KAAK,qBAAqB;AAAG;AAAA,YAAO;AAChF,gBAAIA,uBAAOA,cAAAA,MAAI,UAAU;AAAEA,4BAAG,MAAC,SAAS,EAAE,KAAK,qBAAqB;AAAG;AAAA,YAAO;AAC9E,gBAAIA,uBAAOA,cAAAA,MAAI,YAAY;AAAEA,4BAAG,MAAC,WAAW,EAAE,KAAK,qBAAqB;AAAG;AAAA,YAAO;AAAA,UACpF,SAAS,GAAG;AACV,gBAAI;AAAEA,4BAAAA,MAAI,WAAW,EAAE,KAAK,qBAAqB;AAAA,YAAA,SAAW,IAAI;AAAA,YAAC;AAAA,UACnE;AAAA,QACD,GAAE,GAAG;AAAA,OACP,EACA,MAAM,CAAC,QAAQ;AACdA,sBAAAA,MAAA,MAAA,SAAA,+BAAc,eAAe,GAAG;AAChCA,sBAAG,MAAC,UAAU,EAAE,OAAO,WAAW,MAAM,QAAQ;AAAA,OACjD,EACA,QAAQ,MAAM;AAAE,YAAI;AAAEA,wBAAG,MAAC,YAAW;AAAA,iBAAY,GAAG;AAAA,QAAA;AAAA,OAAI;AAAA,IAC7D;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;ACrFA,GAAG,WAAW,eAAe;"}