{"version":3,"file":"index.js","sources":["pages/announcement/index.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYW5ub3VuY2VtZW50L2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"page\">\r\n    <Skeleton :loading=\"loading\" :showTitle=\"true\" />\r\n    <!-- #ifdef H5 -->\r\n    <view class=\"h5-mask\">\r\n      <view class=\"h5-modal\">\r\n        <view class=\"modal-header\">\r\n          <text class=\"modal-title\">公告</text>\r\n          <view class=\"modal-close\" @click=\"goBack\">✕</view>\r\n        </view>\r\n        <view v-if=\"announcement\" class=\"modal-body\">\r\n          <view class=\"modal-body-two\">\r\n            <view class=\"two-left\" @click=\"showAnnContent = true\">\r\n              <text class=\"two-label\">公告标题</text>\r\n              <view class=\"two-title\">{{ announcement.title }}</view>\r\n            </view>\r\n            <view class=\"two-right\">\r\n              <view v-if=\"showAnnContent\">\r\n                <text class=\"a-title\">{{ announcement.title }}</text>\r\n                <text class=\"a-time\">{{ displayTime }}</text>\r\n                <view class=\"a-content\">{{ announcement.content }}</view>\r\n              </view>\r\n              <view v-else class=\"two-hint\">点击右侧显示公告内容</view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        <view v-else class=\"modal-body empty\">\r\n          <text>暂无公告</text>\r\n        </view>\r\n      </view>\r\n    </view>\r\n    <!-- #endif -->\r\n    <!-- #ifndef H5 -->\r\n    <!-- 小程序等端保留原样式 -->\r\n    <image class=\"page-bg\" src=\"/static/product_detail_background.jpg\" mode=\"aspectFill\" />\r\n    <view class=\"container\">\r\n      <view class=\"header\">\r\n        <text class=\"title\">公告</text>\r\n      </view>\r\n      <view v-if=\"announcement\" class=\"card\">\r\n        <text class=\"a-title\">{{ announcement.title }}</text>\r\n        <text class=\"a-time\">{{ displayTime }}</text>\r\n        <view class=\"a-content\">{{ announcement.content }}</view>\r\n      </view>\r\n      <view v-else class=\"empty\">\r\n        <text>暂无公告</text>\r\n      </view>\r\n    </view>\r\n    <!-- #endif -->\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport Skeleton from '@/components/Skeleton.vue'\r\nimport FloatingNav from '@/components/FloatingNav.vue'\r\nimport { getCurrentAnnouncement } from '../../api/index.js'\r\nexport default {\r\n  components: { Skeleton, FloatingNav },\r\n  data() {\r\n    return {\r\n      loading: true,\r\n      announcement: null,\r\n      showAnnContent: true\r\n    }\r\n  },\r\n  computed: {\r\n    displayTime() {\r\n      try {\r\n        const t = this.announcement?.created_at || this.announcement?.timestamp || ''\r\n        if (!t) return ''\r\n        const d = new Date(t)\r\n        if (isNaN(d.getTime())) return String(t)\r\n        const y = d.getFullYear()\r\n        const m = String(d.getMonth() + 1).padStart(2, '0')\r\n        const day = String(d.getDate()).padStart(2, '0')\r\n        const h = String(d.getHours()).padStart(2, '0')\r\n        const mm = String(d.getMinutes()).padStart(2, '0')\r\n        return `${y}-${m}-${day} ${h}:${mm}`\r\n      } catch (e) { return '' }\r\n    }\r\n  },\r\n  onShow() {\r\n    this.fetch()\r\n  },\r\n  methods: {\r\n    goBack() {\r\n      if (typeof window !== 'undefined' && window.history && window.history.length > 1) { window.history.back(); return }\r\n      if (uni && uni.switchTab) { uni.switchTab({ url: '/pages/home/index' }); return }\r\n      if (uni && uni.navigateTo) { uni.navigateTo({ url: '/pages/home/index' }); return }\r\n    },\r\n    fetch() {\r\n      try {\r\n        const u = uni.getStorageSync('user') || null\r\n        const token = (u && (u.token || (u.data && u.data.token))) || ''\r\n        getCurrentAnnouncement({ token }).then(res => {\r\n          const ok = !!(res && res.success)\r\n          const data = res?.data || null\r\n          if (ok && data) {\r\n            this.announcement = {\r\n              id: data.announcement_id || data.id || '',\r\n              title: data.title || '',\r\n              content: data.content || '',\r\n              created_at: data.created_at || res.timestamp || ''\r\n            }\r\n          } else {\r\n            this.announcement = null\r\n          }\r\n        }).catch(() => { this.announcement = null })\r\n      } catch (e) { this.announcement = null }\r\n      finally { this.loading = false }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.page { min-height: 100vh; }\r\n.page-bg {\r\n  position: fixed; left: 0; right: 0; top: 0; bottom: 0;\r\n  width: 100vw; height: 100vh; z-index: -1;\r\n}\r\n.h5-mask { position: fixed; left: 0; right: 0; top: 0; bottom: 0; background: rgba(0,0,0,.45); display: flex; align-items: center; justify-content: center; z-index: 9999; }\r\n.h5-modal { width: 820rpx; max-width: 90vw; background: #fff; border-radius: 16rpx; padding: 24rpx; box-shadow: 0 12rpx 28rpx rgba(0, 0, 0, 0.12); display: flex; flex-direction: column; height: 60vh; }\r\n.modal-header { display: flex; align-items: center; justify-content: space-between; padding-bottom: 12rpx; border-bottom: 1rpx solid #f0f0f0; margin-bottom: 16rpx; }\r\n.modal-title { font-size: 32rpx; font-weight: 700; color: #333; }\r\n.modal-close { width: 60rpx; height: 60rpx; display: flex; align-items: center; justify-content: center; font-size: 32rpx; color: #999; cursor: pointer; }\r\n.modal-close:active { color: #333; }\r\n.modal-body { flex: 1; min-height: 0; overflow-y: auto; }\r\n.modal-body-two { display: flex; gap: 16rpx; height: 100%; }\r\n.two-left { width: 280rpx; flex-shrink: 0; padding-right: 16rpx; border-right: 1rpx solid #f0f0f0; display: flex; flex-direction: column; gap: 12rpx; }\r\n.two-left { cursor: pointer; }\r\n.two-label { font-size: 24rpx; color: #999; }\r\n.two-title { font-size: 30rpx; color: #333; font-weight: 600; }\r\n.two-right { flex: 1; min-height: 0; overflow-y: auto; padding-left: 16rpx; }\r\n.two-hint { height: 100%; display: flex; align-items: center; justify-content: center; color: #999; font-size: 26rpx; }\r\n.container {\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  padding: 40rpx;\r\n}\r\n.header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 20rpx;\r\n}\r\n.title {\r\n  font-size: 36rpx;\r\n  font-weight: 700;\r\n  color: #000;\r\n}\r\n.card {\r\n  background: #fff;\r\n  border: 1rpx solid #eee;\r\n  border-radius: 12rpx;\r\n  padding: 20rpx;\r\n}\r\n.a-title {\r\n  font-size: 34rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n  display: block;\r\n}\r\n.a-time {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  display: block;\r\n  margin-top: 8rpx;\r\n  margin-bottom: 16rpx;\r\n}\r\n.a-content {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  line-height: 1.6;\r\n  white-space: pre-wrap;\r\n}\r\n.empty {\r\n  text-align: center;\r\n  color: #999;\r\n  padding: 40rpx 0;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/HP/Desktop/LiShop/LiShop/pages/announcement/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getCurrentAnnouncement"],"mappings":";;;;AAqDA,MAAO,WAAU,MAAW;AAC5B,oBAAoB,MAAW;AAE/B,MAAK,YAAU;AAAA,EACb,YAAY,EAAE,UAAU,YAAa;AAAA,EACrC,OAAO;AACL,WAAO;AAAA,MACL,SAAS;AAAA,MACT,cAAc;AAAA,MACd,gBAAgB;AAAA,IAClB;AAAA,EACD;AAAA,EACD,UAAU;AAAA,IACR,cAAc;;AACZ,UAAI;AACF,cAAM,MAAI,UAAK,iBAAL,mBAAmB,iBAAc,UAAK,iBAAL,mBAAmB,cAAa;AAC3E,YAAI,CAAC;AAAG,iBAAO;AACf,cAAM,IAAI,IAAI,KAAK,CAAC;AACpB,YAAI,MAAM,EAAE,QAAS,CAAA;AAAG,iBAAO,OAAO,CAAC;AACvC,cAAM,IAAI,EAAE,YAAY;AACxB,cAAM,IAAI,OAAO,EAAE,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AAClD,cAAM,MAAM,OAAO,EAAE,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAC/C,cAAM,IAAI,OAAO,EAAE,SAAU,CAAA,EAAE,SAAS,GAAG,GAAG;AAC9C,cAAM,KAAK,OAAO,EAAE,WAAY,CAAA,EAAE,SAAS,GAAG,GAAG;AACjD,eAAO,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE;AAAA,MACpC,SAAS,GAAG;AAAE,eAAO;AAAA,MAAG;AAAA,IAC1B;AAAA,EACD;AAAA,EACD,SAAS;AACP,SAAK,MAAM;AAAA,EACZ;AAAA,EACD,SAAS;AAAA,IACP,SAAS;AACP,UAAI,OAAO,WAAW,eAAe,OAAO,WAAW,OAAO,QAAQ,SAAS,GAAG;AAAE,eAAO,QAAQ,KAAM;AAAE;AAAA,MAAO;AAClH,UAAIA,uBAAOA,cAAAA,MAAI,WAAW;AAAEA,sBAAG,MAAC,UAAU,EAAE,KAAK,qBAAqB;AAAG;AAAA,MAAO;AAChF,UAAIA,uBAAOA,cAAAA,MAAI,YAAY;AAAEA,sBAAG,MAAC,WAAW,EAAE,KAAK,qBAAqB;AAAG;AAAA,MAAO;AAAA,IACnF;AAAA,IACD,QAAQ;AACN,UAAI;AACF,cAAM,IAAIA,cAAG,MAAC,eAAe,MAAM,KAAK;AACxC,cAAM,QAAS,MAAM,EAAE,SAAU,EAAE,QAAQ,EAAE,KAAK,UAAY;AAC9DC,kBAAAA,uBAAuB,EAAE,MAAI,CAAG,EAAE,KAAK,SAAO;AAC5C,gBAAM,KAAK,CAAC,EAAE,OAAO,IAAI;AACzB,gBAAM,QAAO,2BAAK,SAAQ;AAC1B,cAAI,MAAM,MAAM;AACd,iBAAK,eAAe;AAAA,cAClB,IAAI,KAAK,mBAAmB,KAAK,MAAM;AAAA,cACvC,OAAO,KAAK,SAAS;AAAA,cACrB,SAAS,KAAK,WAAW;AAAA,cACzB,YAAY,KAAK,cAAc,IAAI,aAAa;AAAA,YAClD;AAAA,iBACK;AACL,iBAAK,eAAe;AAAA,UACtB;AAAA,QACF,CAAC,EAAE,MAAM,MAAM;AAAE,eAAK,eAAe;AAAA,SAAM;AAAA,MAC7C,SAAS,GAAG;AAAE,aAAK,eAAe;AAAA,MAAK;AAC7B,aAAK,UAAU;AAAA,MAAM;AAAA,IACjC;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;AC/GA,GAAG,WAAW,eAAe;"}