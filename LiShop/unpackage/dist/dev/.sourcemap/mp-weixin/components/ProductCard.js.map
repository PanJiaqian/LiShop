{"version":3,"file":"ProductCard.js","sources":["components/ProductCard.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvSFAvRGVza3RvcC9MaVNob3AvTGlTaG9wL2NvbXBvbmVudHMvUHJvZHVjdENhcmQudnVl"],"sourcesContent":["<template>\r\n  <view>\r\n    <LoginPrompt :visible=\"showLoginModal\" @close=\"closeLoginModal\" @confirm=\"goLogin\" />\r\n    <view class=\"card\" @click=\"openDetail\">\r\n    <image class=\"cover\" :src=\"product.image || '/static/logo.png'\" mode=\"aspectFill\" />\r\n    <view class=\"info\">\r\n      <text class=\"title\">{{ product.title }}</text>\r\n      <view class=\"price-row\">\r\n        <view class=\"price\">\r\n          <text v-if=\"!displayPriceParts.textMsg\" class=\"price-icon\">¥</text>\r\n          <text v-if=\"!displayPriceParts.textMsg\" class=\"price-amount\">{{ displayPriceParts.amount }}</text>\r\n          <text v-else class=\"price-text\">{{ displayPriceParts.textMsg }}</text>\r\n        </view>\r\n        <text class=\"sales\">已售 {{ product.sales }}</text>\r\n      </view>\r\n      <view class=\"actions\">\r\n        <!-- <button class=\"btn-cart\" size=\"mini\" @click.stop=\"add\">加入购物车</button> -->\r\n      </view>\r\n    </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport LoginPrompt from '@/components/LoginPrompt.vue'\r\nexport default {\r\n  name: 'ProductCard',\r\n  props: {\r\n    product: { type: Object, required: true }\r\n  },\r\n  emits: ['add-to-cart'],\r\n  data() {\r\n    return { showLoginModal: false }\r\n  },\r\n  components: { LoginPrompt },\r\n  computed: {\r\n    displayPriceParts() {\r\n      try {\r\n        const v = this.product && this.product.price\r\n        if (v === '-' || v === '—') return { textMsg: '登录可查看售价' }\r\n        const n = Number(v)\r\n        if (isNaN(n)) return { textMsg: '---' }\r\n        return { amount: n.toFixed(2) }\r\n      } catch (e) { return { textMsg: '---' } }\r\n    }\r\n  },\r\n  methods: {\r\n    ensureLoggedIn() {\r\n      try {\r\n        const u = uni.getStorageSync('user') || null\r\n        const exp = uni.getStorageSync('token_expiration') || 0\r\n        const ok = !!u && (!exp || Date.now() < exp)\r\n        if (ok) return true\r\n        this.showLoginModal = true\r\n        return false\r\n      } catch (e) { return false }\r\n    },\r\n    closeLoginModal() { this.showLoginModal = false },\r\n    goLogin() { this.showLoginModal = false; uni.navigateTo({ url: '/pages/login/index' }) },\r\n    add() {\r\n      this.$emit('add-to-cart', this.product)\r\n    },\r\n    openDetail() {\r\n      if (!this.ensureLoggedIn()) return\r\n      const id = this.product?.id ?? ''\r\n      const url = '/pages/product/index?id=' + encodeURIComponent(id)\r\n      if (typeof window !== 'undefined' && window.open) {\r\n        const base = (typeof location !== 'undefined' && location.href) ? location.href.split('#')[0] : ''\r\n        const full = base ? (base + '#/pages/product/index?id=' + encodeURIComponent(id)) : url\r\n        window.open(full, '_blank')\r\n      } else {\r\n        uni.navigateTo({ url })\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.card {\r\n  background: #fff;\r\n  border-radius: 12rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.cover {\r\n  width: 100%;\r\n  height: 300rpx;\r\n  background: #f5f5f5;\r\n  display: block;\r\n}\r\n\r\n.info {\r\n  padding: 16rpx;\r\n}\r\n\r\n.title {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  line-height: 1.4;\r\n  display: block;\r\n  height: 80rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.price-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-top: 12rpx;\r\n}\r\n\r\n.price {\r\n  display: flex;\r\n  align-items: baseline;\r\n  gap: 12rpx;\r\n}\r\n.price-icon {\r\n  color: #000;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n}\r\n.price-amount {\r\n  color: #000;\r\n  font-size: 30rpx;\r\n  font-weight: 700;\r\n}\r\n.price-text {\r\n  color: #000;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n}\r\n\r\n/* #ifdef MP-WEIXIN */\r\n.price-icon { color: #000; }\r\n.price-amount { color: #000; }\r\n.price-text { color: #000; }\r\n/* #endif */\r\n\r\n.sales {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n}\r\n\r\n.actions {\r\n  margin-top: 12rpx;\r\n  display: flex;\r\n}\r\n\r\n.btn-cart {\r\n  background: #ff5500;\r\n  color: #fff;\r\n  border-radius: 8rpx;\r\n}\r\n</style>\r\n","import Component from 'C:/Users/HP/Desktop/LiShop/LiShop/components/ProductCard.vue'\nwx.createComponent(Component)"],"names":["uni"],"mappings":";;AAwBA,oBAAoB,MAAW;AAC/B,MAAK,YAAU;AAAA,EACb,MAAM;AAAA,EACN,OAAO;AAAA,IACL,SAAS,EAAE,MAAM,QAAQ,UAAU,KAAK;AAAA,EACzC;AAAA,EACD,OAAO,CAAC,aAAa;AAAA,EACrB,OAAO;AACL,WAAO,EAAE,gBAAgB,MAAM;AAAA,EAChC;AAAA,EACD,YAAY,EAAE,YAAa;AAAA,EAC3B,UAAU;AAAA,IACR,oBAAoB;AAClB,UAAI;AACF,cAAM,IAAI,KAAK,WAAW,KAAK,QAAQ;AACvC,YAAI,MAAM,OAAO,MAAM;AAAK,iBAAO,EAAE,SAAS,UAAU;AACxD,cAAM,IAAI,OAAO,CAAC;AAClB,YAAI,MAAM,CAAC;AAAG,iBAAO,EAAE,SAAS,MAAM;AACtC,eAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,EAAE;AAAA,MAChC,SAAS,GAAG;AAAE,eAAO,EAAE,SAAS;MAAQ;AAAA,IAC1C;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,iBAAiB;AACf,UAAI;AACF,cAAM,IAAIA,cAAG,MAAC,eAAe,MAAM,KAAK;AACxC,cAAM,MAAMA,cAAG,MAAC,eAAe,kBAAkB,KAAK;AACtD,cAAM,KAAK,CAAC,CAAC,MAAM,CAAC,OAAO,KAAK,IAAI,IAAI;AACxC,YAAI;AAAI,iBAAO;AACf,aAAK,iBAAiB;AACtB,eAAO;AAAA,MACT,SAAS,GAAG;AAAE,eAAO;AAAA,MAAM;AAAA,IAC5B;AAAA,IACD,kBAAkB;AAAE,WAAK,iBAAiB;AAAA,IAAO;AAAA,IACjD,UAAU;AAAE,WAAK,iBAAiB;AAAOA,0BAAI,WAAW,EAAE,KAAK,qBAAqB,CAAC;AAAA,IAAG;AAAA,IACxF,MAAM;AACJ,WAAK,MAAM,eAAe,KAAK,OAAO;AAAA,IACvC;AAAA,IACD,aAAa;;AACX,UAAI,CAAC,KAAK,eAAc;AAAI;AAC5B,YAAM,OAAK,UAAK,YAAL,mBAAc,OAAM;AAC/B,YAAM,MAAM,6BAA6B,mBAAmB,EAAE;AAC9D,UAAI,OAAO,WAAW,eAAe,OAAO,MAAM;AAChD,cAAM,OAAQ,OAAO,aAAa,eAAe,SAAS,OAAQ,SAAS,KAAK,MAAM,GAAG,EAAE,CAAC,IAAI;AAChG,cAAM,OAAO,OAAQ,OAAO,8BAA8B,mBAAmB,EAAE,IAAK;AACpF,eAAO,KAAK,MAAM,QAAQ;AAAA,aACrB;AACLA,4BAAI,WAAW,EAAE,KAAK;AAAA,MACxB;AAAA,IACF;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1EA,GAAG,gBAAgB,SAAS;"}