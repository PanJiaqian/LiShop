"use strict";const e=require("../../common/vendor.js"),t={data:()=>({order:null,orders:[]}),onLoad(t){const r=Number(null==t?void 0:t.id),o=e.index.getStorageSync("orders")||[];r?this.order=o.find((e=>e.id===r))||null:this.orders=o},methods:{formatTime(e){try{return new Date(e).toLocaleString()}catch{return e}},copyWaybill(t){try{e.index.setClipboardData({data:String(t)}),e.index.showToast({title:"已复制运单号",icon:"success"})}catch(r){}},openDetail(t){e.index.navigateTo({url:"/pages/order/index?id="+t})},firstThumbs(e){try{const t=[];return e.rooms.forEach((e=>e.items.forEach((e=>t.push(e.image||"/static/logo.png"))))),t.slice(0,3)}catch{return[]}},exportExcel(t){try{let r='<table border="1" cellspacing="0" cellpadding="4"><tr>'+["房间","商品","型号","色温","长度","单价","数量","金额"].map((e=>`<th>${e}</th>`)).join("")+"</tr>";t.rooms.forEach((e=>{e.items.forEach((t=>{const o=[e.name,t.title,t.id,t.specTemp||"",t.specLength||"",t.price.toFixed(2),t.quantity,(t.price*t.quantity).toFixed(2)];r+="<tr>"+o.map((e=>`<td>${e}</td>`)).join("")+"</tr>"}))})),r+="</table>";const o=new Blob([`\ufeff${r}`],{type:"application/vnd.ms-excel"}),d=URL.createObjectURL(o),i=document.createElement("a");i.href=d,i.download=`订单_${t.id}.xls`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(d),e.index.showToast({title:"已导出Excel",icon:"success"})}catch(r){e.index.showToast({title:"导出仅支持H5",icon:"none"})}}}};const r=e._export_sfc(t,[["render",function(t,r,o,d,i,a){return e.e({a:i.order},i.order?e.e({b:e.t(i.order.orderNo||i.order.id),c:e.t(a.formatTime(i.order.createdAt)),d:e.t(i.order.total.toFixed(2)),e:i.order.waybillNo},i.order.waybillNo?{f:e.t(i.order.waybillNo),g:e.o((e=>a.copyWaybill(i.order.waybillNo)))}:{},{h:(i.order.tracking||[]).length},(i.order.tracking||[]).length?{i:e.f(i.order.tracking,((t,r,o)=>e.e({a:e.t(t.status),b:e.t(t.desc),c:e.t(a.formatTime(t.time)),d:t.place},t.place?{e:e.t(t.place)}:{},{f:r})))}:{},{j:e.f(i.order.rooms,((t,r,o)=>({a:e.t(t.name),b:e.t(t.roomTotal.toFixed(2)),c:e.f(t.items,((t,r,o)=>({a:e.t(t.title),b:e.t(t.id),c:e.t(t.specTemp||"-"),d:e.t(t.specLength||"-"),e:e.t(t.price.toFixed(2)),f:e.t(t.quantity),g:e.t((t.price*t.quantity).toFixed(2)),h:t.id+"_"+t.specLength+"_"+t.specTemp}))),d:t.name}))),k:e.o((e=>a.exportExcel(i.order)))}):e.e({l:i.orders.length},i.orders.length?{m:e.f(i.orders,((t,r,o)=>({a:e.t(t.orderNo||t.id),b:e.t(a.formatTime(t.createdAt)),c:e.t(t.total.toFixed(2)),d:e.f(a.firstThumbs(t),((e,t,r)=>({a:t,b:e}))),e:e.o((e=>a.openDetail(t.id)),t.id),f:t.id})))}:{}))}],["__scopeId","data-v-6babba8b"]]);wx.createPage(r);
