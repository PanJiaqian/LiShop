"use strict";const t=require("../../common/vendor.js"),e={data:()=>({product:null,current:0,qty:1,specTemp:"",specLength:"",roomName:"",mpSheet:!1,mpTemp:"",mpLength:"",mpRoom:"",mpQty:1}),onLoad(t){const e=decodeURIComponent((null==t?void 0:t.id)||""),o={id:e,title:"商品 "+(e||"X"),price:199,sales:100,image:"/static/logo.png",images:["/static/logo.png","/static/logo.png","/static/logo.png"]};this.product=o},computed:{images(){var t;const e=this.product&&this.product.images||[];return e.length?e:[(null==(t=this.product)?void 0:t.image)||"/static/logo.png"]},currentImage(){const t=this.images;return t[this.current]||t[0]}},methods:{addToCart(){try{const e=t.index.getStorageSync("cart")||[],o=e.findIndex((t=>t.id===this.product.id));o>=0?e[o].quantity=(e[o].quantity||1)+1:e.push({...this.product,quantity:1}),t.index.setStorageSync("cart",e),t.index.showToast({title:"已加入购物车",icon:"success"})}catch(e){console.error(e)}},incQty(){this.qty+=1},decQty(){this.qty=Math.max(1,this.qty-1)},addToCartWithQty(){const e=(this.roomName||"").trim();if(e)try{const o=t.index.getStorageSync("cart")||[],c=o.findIndex((t=>t.id===this.product.id));c>=0?(o[c].quantity=(o[c].quantity||1)+this.qty,o[c].specTemp=this.specTemp,o[c].specLength=this.specLength,o[c].roomName=e):o.push({...this.product,quantity:this.qty,specTemp:this.specTemp,specLength:this.specLength,roomName:e});const s=t.index.getStorageSync("rooms")||[];s.includes(e)||(s.push(e),t.index.setStorageSync("rooms",s)),t.index.setStorageSync("cart",o),t.index.showToast({title:`已加入房间：${e}`,icon:"success"})}catch(o){console.error(o)}else t.index.showToast({title:"请先填写房间名",icon:"none"})},buyNow(){t.index.showToast({title:"暂未接入下单",icon:"none"})},openSpecSheet(){this.mpSheet=!0},closeSpecSheet(){this.mpSheet=!1},confirmSpecToCart(){if(!(this.mpRoom&&this.mpTemp&&this.mpLength&&this.mpQty))return void t.index.showToast({title:"请填写房间名、色温、长度、数量",icon:"none"});const e=(this.mpRoom||"").trim();try{const o=t.index.getStorageSync("cart")||[],c=o.findIndex((t=>t.id===this.product.id));c>=0?(o[c].quantity=(o[c].quantity||1)+this.mpQty,o[c].specTemp=this.mpTemp,o[c].specLength=this.mpLength,o[c].roomName=e):o.push({...this.product,quantity:this.mpQty,specTemp:this.mpTemp,specLength:this.mpLength,roomName:e});const s=t.index.getStorageSync("rooms")||[];s.includes(e)||(s.push(e),t.index.setStorageSync("rooms",s)),t.index.setStorageSync("cart",o),this.mpSheet=!1,t.index.showToast({title:`已加入房间：${e}`,icon:"success"})}catch(o){console.error(o)}}}};const o=t._export_sfc(e,[["render",function(e,o,c,s,i,n){return t.e({a:i.product},i.product?t.e({b:i.product.image||"/static/logo.png",c:t.t(i.product.title),d:t.t(i.product.price.toFixed(2)),e:t.t(i.product.sales),f:t.t(i.product.id||"默认款"),g:t.t(i.product.title),h:t.t(i.product.price.toFixed(2)),i:t.f(n.images,((t,e,o)=>({a:"md"+e,b:t}))),j:t.o(((...t)=>n.openSpecSheet&&n.openSpecSheet(...t))),k:i.mpSheet},i.mpSheet?{l:i.mpRoom,m:t.o((t=>i.mpRoom=t.detail.value)),n:i.mpTemp,o:t.o((t=>i.mpTemp=t.detail.value)),p:i.mpLength,q:t.o((t=>i.mpLength=t.detail.value)),r:t.o((t=>i.mpQty=Math.max(1,i.mpQty-1))),s:t.t(i.mpQty),t:t.o((t=>i.mpQty=i.mpQty+1)),v:t.o(((...t)=>n.closeSpecSheet&&n.closeSpecSheet(...t))),w:t.o(((...t)=>n.confirmSpecToCart&&n.confirmSpecToCart(...t))),x:t.o((()=>{})),y:t.o(((...t)=>n.closeSpecSheet&&n.closeSpecSheet(...t)))}:{}):{})}],["__scopeId","data-v-5ecce86c"]]);wx.createPage(o);
