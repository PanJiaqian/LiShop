import{k as e,G as t,m as a,n as l,c as s,w as o,d,o as r,a as c,b as i,t as u,v as n,f,r as m,F as _,i as p,e as y,g as h}from"./index-D--6mQz1.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const g=b({data:()=>({order:null,orders:[]}),onLoad(t){const a=Number(null==t?void 0:t.id),l=e("orders")||[];a?this.order=l.find((e=>e.id===a))||null:this.orders=l},methods:{formatTime(e){try{return new Date(e).toLocaleString()}catch{return e}},copyWaybill(e){try{t({data:String(e)}),a({title:"已复制运单号",icon:"success"})}catch(l){}},openDetail(e){l({url:"/pages/order/index?id="+e})},firstThumbs(e){try{const t=[];return e.rooms.forEach((e=>e.items.forEach((e=>t.push(e.image||"/static/logo.png"))))),t.slice(0,3)}catch{return[]}},exportExcel(e){try{let t='<table border="1" cellspacing="0" cellpadding="4"><tr>'+["房间","商品","型号","色温","长度","单价","数量","金额"].map((e=>`<th>${e}</th>`)).join("")+"</tr>";e.rooms.forEach((e=>{e.items.forEach((a=>{const l=[e.name,a.title,a.id,a.specTemp||"",a.specLength||"",a.price.toFixed(2),a.quantity,(a.price*a.quantity).toFixed(2)];t+="<tr>"+l.map((e=>`<td>${e}</td>`)).join("")+"</tr>"}))})),t+="</table>";const l=new Blob([`\ufeff${t}`],{type:"application/vnd.ms-excel"}),s=URL.createObjectURL(l),o=document.createElement("a");o.href=s,o.download=`订单_${e.id}.xls`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),a({title:"已导出Excel",icon:"success"})}catch(t){a({title:"导出仅支持H5",icon:"none"})}}}},[["render",function(e,t,a,l,b,g){const k=p,x=d,T=y,w=h;return r(),s(x,{class:"page"},{default:o((()=>[b.order?(r(),s(x,{key:0,class:"order"},{default:o((()=>[c(x,{class:"header"},{default:o((()=>[c(k,{class:"title"},{default:o((()=>[i("订单号："+u(b.order.orderNo||b.order.id),1)])),_:1}),c(k,{class:"time"},{default:o((()=>[i("下单时间："+u(g.formatTime(b.order.createdAt)),1)])),_:1}),c(k,{class:"total"},{default:o((()=>[i("合计：¥"+u(b.order.total.toFixed(2)),1)])),_:1})])),_:1}),b.order.waybillNo?(r(),s(x,{key:0,class:"waybill"},{default:o((()=>[c(k,null,{default:o((()=>[i("运单号："+u(b.order.waybillNo),1)])),_:1}),c(T,{size:"mini",class:"copy",onClick:t[0]||(t[0]=e=>g.copyWaybill(b.order.waybillNo))},{default:o((()=>[i("复制运单号")])),_:1})])),_:1})):n("",!0),(b.order.tracking||[]).length?(r(),s(x,{key:1,class:"logistics"},{default:o((()=>[(r(!0),f(_,null,m(b.order.tracking,((e,t)=>(r(),s(x,{class:"log-item",key:t},{default:o((()=>[c(x,{class:"dot"},{default:o((()=>[i("•")])),_:1}),c(x,{class:"log-meta"},{default:o((()=>[c(k,{class:"log-status"},{default:o((()=>[i(u(e.status),1)])),_:2},1024),c(k,{class:"log-desc"},{default:o((()=>[i(u(e.desc),1)])),_:2},1024),c(k,{class:"log-time"},{default:o((()=>[i(u(g.formatTime(e.time)),1)])),_:2},1024),e.place?(r(),s(k,{key:0,class:"log-place"},{default:o((()=>[i(u(e.place),1)])),_:2},1024)):n("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):n("",!0),c(x,{class:"rooms"},{default:o((()=>[(r(!0),f(_,null,m(b.order.rooms,(e=>(r(),s(x,{class:"room",key:e.name},{default:o((()=>[c(x,{class:"room-hd"},{default:o((()=>[c(k,{class:"room-name"},{default:o((()=>[i(u(e.name),1)])),_:2},1024),c(k,{class:"room-total"},{default:o((()=>[i("小计：¥"+u(e.roomTotal.toFixed(2)),1)])),_:2},1024)])),_:2},1024),c(x,{class:"items"},{default:o((()=>[(r(!0),f(_,null,m(e.items,(e=>(r(),s(x,{class:"item",key:e.id+"_"+e.specLength+"_"+e.specTemp},{default:o((()=>[c(x,{class:"meta"},{default:o((()=>[c(k,{class:"title"},{default:o((()=>[i(u(e.title),1)])),_:2},1024),c(k,{class:"spec"},{default:o((()=>[i("型号："+u(e.id)+"｜色温："+u(e.specTemp||"-")+"｜长度："+u(e.specLength||"-"),1)])),_:2},1024)])),_:2},1024),c(x,{class:"price-row"},{default:o((()=>[c(k,null,{default:o((()=>[i("¥"+u(e.price.toFixed(2)),1)])),_:2},1024),c(k,null,{default:o((()=>[i("× "+u(e.quantity),1)])),_:2},1024),c(k,null,{default:o((()=>[i("＝ ¥"+u((e.price*e.quantity).toFixed(2)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1}),c(x,{class:"ops"},{default:o((()=>[c(T,{class:"btn",onClick:t[1]||(t[1]=e=>g.exportExcel(b.order))},{default:o((()=>[i("导出Excel")])),_:1})])),_:1})])),_:1})):(r(),s(x,{key:1,class:"orders"},{default:o((()=>[b.orders.length?(r(),s(x,{key:0,class:"orders-list"},{default:o((()=>[(r(!0),f(_,null,m(b.orders,(e=>(r(),s(x,{class:"order-card",key:e.id},{default:o((()=>[c(x,{class:"card-hd"},{default:o((()=>[c(k,{class:"id"},{default:o((()=>[i("订单号："+u(e.orderNo||e.id),1)])),_:2},1024),c(k,{class:"time"},{default:o((()=>[i("下单时间："+u(g.formatTime(e.createdAt)),1)])),_:2},1024),c(k,{class:"total"},{default:o((()=>[i("¥"+u(e.total.toFixed(2)),1)])),_:2},1024)])),_:2},1024),c(x,{class:"card-body"},{default:o((()=>[c(x,{class:"thumbs"},{default:o((()=>[(r(!0),f(_,null,m(g.firstThumbs(e),((e,t)=>(r(),s(w,{key:t,src:e,mode:"aspectFill",class:"thumb"},null,8,["src"])))),128))])),_:2},1024),c(x,{class:"actions"},{default:o((()=>[c(T,{size:"mini",onClick:t=>g.openDetail(e.id)},{default:o((()=>[i("查看详情")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(r(),s(x,{key:1,class:"empty"},{default:o((()=>[i("暂无订单")])),_:1}))])),_:1}))])),_:1})}],["__scopeId","data-v-6babba8b"]]);export{g as default};
