import{j as e,m as i,n as t,u as a,c as s,w as n,d,o,a as c,f as l,r,F as g,b as h,t as v,y as u,z as m,i as p,g as _}from"./index-D--6mQz1.js";import{F as I}from"./FloatingNav.BIlG4RBz.js";import{g as f}from"./index.XrWgwEH0.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const C=y({components:{FloatingNav:I},data:()=>({activeIndex:0,categories:[],pendingActiveName:"",pendingActiveId:"",rightChildren:[]}),computed:{activeCategory(){return this.categories[this.activeIndex]||{name:"",children:[]}}},onShow(){try{e({animation:!1})}catch(i){}try{f({page:1,page_size:50,sort_by:"id"}).then((e=>{var i;const t=(Array.isArray(null==(i=null==e?void 0:e.data)?void 0:i.items)?e.data.items:[]).map(((e,i)=>({name:(null==e?void 0:e.name)||"分类"+(i+1),categories_id:(null==e?void 0:e.categories_id)||(null==e?void 0:e.id)||"",children:[]})));if(this.categories=t,this.pendingActiveId){const e=this.categories.findIndex((e=>e.categories_id===this.pendingActiveId));e>=0&&(this.activeIndex=e,this.loadChildrenById(this.pendingActiveId)),this.pendingActiveId="",this.pendingActiveName=""}else if(this.pendingActiveName){const e=this.categories.findIndex((e=>e.name===this.pendingActiveName));if(e>=0){this.activeIndex=e;const i=this.categories[e].categories_id;i&&this.loadChildrenById(i)}this.pendingActiveName=""}else if(this.categories.length){this.activeIndex=0;const e=this.categories[0].categories_id;e&&this.loadChildrenById(e)}})).catch((()=>{}))}catch(i){}},onLoad(e){const i=decodeURIComponent((null==e?void 0:e.active)||""),t=decodeURIComponent((null==e?void 0:e.active_id)||"");this.pendingActiveName=i,this.pendingActiveId=t},methods:{selectCategory(e){var i;this.activeIndex=e;const t=(null==(i=this.categories[e])?void 0:i.categories_id)||"";t&&this.loadChildrenById(t)},loadChildrenById(e){try{f({page:1,page_size:50,sort_by:"id",categories_id:e}).then((e=>{var i;const t=(Array.isArray(null==(i=null==e?void 0:e.data)?void 0:i.items)?e.data.items:[]).map(((e,i)=>({name:(null==e?void 0:e.name)||"子分类"+(i+1),icon:"",categories_id:(null==e?void 0:e.categories_id)||(null==e?void 0:e.id)||""}))),a=this.activeIndex,s=this.categories[a];s&&this.$set(this.categories,a,{...s,children:t}),this.rightChildren=t})).catch((()=>{}))}catch(i){}},openList(e){var a,s;const n=(null==(a=this.categories[this.activeIndex])?void 0:a.categories_id)||"",d=(null==e?void 0:e.categories_id)||"",o=(null==(s=this.activeCategory)?void 0:s.name)||"";if(!d)return void i({title:"子分类缺少ID",icon:"none"});const c=`/pages/category/list?parent_id=${encodeURIComponent(n)}&category_id=${encodeURIComponent(d)}&active=${encodeURIComponent(o)}`;t({url:c})}}},[["render",function(e,i,t,I,f,y){const C=p,A=d,x=u,b=_,N=a("FloatingNav");return o(),s(A,{class:"page"},{default:n((()=>[c(A,{class:"container"},{default:n((()=>[c(x,{class:"left","scroll-y":""},{default:n((()=>[(o(!0),l(g,null,r(f.categories,((e,i)=>(o(),s(A,{key:i,class:m(["left-item",f.activeIndex===i?"active":""]),onClick:e=>y.selectCategory(i)},{default:n((()=>[c(C,null,{default:n((()=>[h(v(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),c(x,{class:"right","scroll-y":""},{default:n((()=>[c(A,{class:"right-wrap"},{default:n((()=>[c(A,{class:"sub-title"},{default:n((()=>[h(v(y.activeCategory.name),1)])),_:1}),c(A,{class:"sub-grid"},{default:n((()=>[(o(!0),l(g,null,r(f.rightChildren,((e,i)=>(o(),s(A,{class:"sub-item",key:i,onClick:i=>y.openList(e)},{default:n((()=>[c(b,{class:"sub-icon",src:e.icon||"/static/logo.png",mode:"aspectFill"},null,8,["src"]),c(C,{class:"sub-name"},{default:n((()=>[h(v(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1}),c(N)])),_:1})}],["__scopeId","data-v-dbdbb395"]]);export{C as default};
